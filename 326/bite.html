<p>In this Bite we familiarise with <em>Abstract Syntax Trees (ASTs)</em>. These are tree data structures used to describe source code based on a programming language grammar.</p>
<p>In Python, an AST can be generated using the <a href="https://docs.python.org/3/library/ast.html?highlight=ast#module-ast" target="_blank" rel="noopener"><code>ast</code> module</a> provided in the standard library. If you are not familiar with this module, we recommend you to check out this <a href="https://pybit.es/ast-intro.html" target="_blank" rel="noopener">read this PyBites tutorial</a> before continuing with this bite.</p>
<p>In this bite we are going to work with an AST visitor, i.e., a class which applies some logic when visiting the nodes of an AST.</p>
<p>More specifically, you need to complete the AST visitor <code>AstPrinter</code> provided in the template so to print the content of a tree according the following formatting rules:</p>
<p>The content of a node is composed of two info: the node name, and a list of attribute name and value pairs.</p>
<p>- Format node names by appending <code>()</code> to their class name.</p>
<p>- Format node attributes names preceding them with <code>.</code> and adding <code>:</code> at the end.</p>
<p>- If an attribute value is neither a node or list of nodes, its formatted value is obtained applying <code>repr()</code> to it.</p>
<p>Print content by "nesting" it.</p>
<p>- A node name is always reported on the next line, adding three white spaces <code>' '</code> more than the one used in the previous line.</p>
<p>- Node attributes are nested under a node name adding three white spaces <code>' '</code> more then the line showing the related node name.</p>
<p>- Given a node, its attributes share the same level of nesting.</p>
<p>When handling node attributes:</p>
<p>- First, print attributes which are neither nodes nor list of nodes. Sort those attributes by their name, and for each of them, print the formatted name and value pair one per line, separating the two info with a single white space.</p>
<p>- Then, sort the remaining attributes by name. For each element, format and print the attribute name on one line, while nesting its content on the following line.</p>
<p>- When the attribute value is a list of nodes, print the formatted attribute name, then nest the nodes content in the following lines without changing their order.</p>
<p>The visitor object can be initialized with <code>show_empty=False</code> to suppress the print of attributes which value is either <code>None</code>, an empty lists <code>[]</code>, or an empty string <code>""</code>.</p>
<p>Here a reference example:</p>
<pre>&gt;&gt;&gt; import ast<br />&gt;&gt;&gt; code = """<br />one_plus_two = 1+2<br />one_plus_two+10<br />"""<br />&gt;&gt;&gt; tree = ast.parse(code)<br />&gt;&gt;&gt; print(ast.dump(tree)) # using the printing provided by the ast module<br />Module(body=[Assign(targets=[Name(id='one_plus_two', ctx=Store())], value=BinOp(left=Constant(value=1), op=Add(), right=Constant(value=2))), Expr(value=BinOp(left=Name(id='one_plus_two', ctx=Load()), op=Add(), right=Constant(value=10)))], type_ignores=[])<br />&gt;&gt;&gt; vst = AstPrinter()<br />&gt;&gt;&gt; vst.visit(tree)<br />Module()<br />&nbsp; &nbsp;.type_ignores: []<br />&nbsp; &nbsp;.body:<br />&nbsp; &nbsp; &nbsp; Assign()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.type_comment: None<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.targets:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Name()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.id: 'one_plus_two'<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.ctx:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Store()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.value:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BinOp()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.left:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Constant()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.kind: None<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.value: 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.op:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Add()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.right:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Constant()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.kind: None<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.value: 2<br />&nbsp; &nbsp; &nbsp; Expr()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.value:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BinOp()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.left:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Name()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.id: 'one_plus_two'<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.ctx:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Load()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.op:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Add()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.right:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Constant()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.kind: None<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.value: 10<br />&gt;&gt;&gt; vst = AstPrinter(show_empty=False) # suppressing empty attributes<br />&gt;&gt;&gt; vst.visit(tree)<br />Module()<br />&nbsp; &nbsp;.body:<br />&nbsp; &nbsp; &nbsp; Assign()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.targets:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Name()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.id: 'one_plus_two'<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.ctx:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Store()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.value:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BinOp()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.left:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Constant()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.value: 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.op:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Add()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.right:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Constant()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.value: 2<br />&nbsp; &nbsp; &nbsp; Expr()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.value:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BinOp()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.left:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Name()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.id: 'one_plus_two'<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.ctx:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Load()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.op:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Add()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.right:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Constant()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.value: 10</pre>
<p>Happy coding in Python!</p>